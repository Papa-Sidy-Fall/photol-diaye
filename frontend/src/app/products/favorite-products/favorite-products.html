<div class="favorite-products-container">
  <button (click)="goBack()" class="back-button">
    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
    </svg>
    Retour
  </button>
  <h2 class="favorite-products-title">Mes produits favoris</h2>

  <div *ngIf="favoriteProducts.length === 0" class="no-products-message">
    <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-5.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 003.586 13H4"></path>
    </svg>
    <h3>Aucun produit favori trouvé</h3>
    <p>Vous n'avez pas encore ajouté de produits à vos favoris.</p>
  </div>

  <div *ngIf="favoriteProducts.length > 0" class="products-grid">
    <div *ngFor="let product of favoriteProducts" class="product-card" (click)="openProductDetailModal(product)">
      <!-- VIP Badge -->
      <div *ngIf="product.vipPoints && product.vipPoints.points > 0" class="product-card-vip-badge">
        <svg fill="currentColor" viewBox="0 0 20 20">
          <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.539 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.83-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.381-1.81.588-1.81h3.462a1 1 0 00.95-.69l1.07-3.292z"></path>
        </svg>
        VIP
      </div>

      <img [src]="product.mainImage" alt="{{ product.title }}" class="product-card-image">

      <div class="product-card-content">
        <h3 class="product-card-title">{{ product.title }}</h3>
        <p class="product-card-description">{{ product.description }}</p>

        <div class="product-card-price-views">
          <p class="product-card-price">{{ product.price | currency:'XOF':'symbol':'1.0-0' }}</p>
          <div class="product-card-views">
            <svg fill="currentColor" viewBox="0 0 20 20">
              <path d="M10 12a2 2 0 100-4 2 2 0 000 4z"></path>
              <path fill-rule="evenodd" d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z" clip-rule="evenodd"></path>
            </svg>
            <span>{{ product.viewCount || 0 }}</span>
          </div>
        </div>

        <div class="product-card-actions">
          <span class="product-card-status"
                [ngClass]="{
                  'status-approved': product.status === 'APPROVED',
                  'status-pending': product.status === 'PENDING',
                  'status-rejected': product.status === 'REJECTED'
                }">
            {{ product.status === 'APPROVED' ? 'Approuvé' : product.status === 'PENDING' ? 'En attente' : product.status === 'REJECTED' ? 'Rejeté' : 'Désactivé' }}
          </span>

          <div class="product-card-buttons">
            <button
              class="product-card-button favorite liked"
              (click)="removeFavorite(product.id); $event.stopPropagation()"
              title="Supprimer des favoris"
            >
              <svg fill="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
              </svg>
            </button>
            <a *ngIf="product.whatsappLink" [href]="product.whatsappLink" target="_blank" class="product-card-button whatsapp" title="Contacter via WhatsApp">
              <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="WhatsApp" class="whatsapp-icon">
            </a>
            <div *ngIf="product.phoneNumber" class="product-card-button phone tooltip-container">
              <a [href]="'tel:' + product.phoneNumber" title="Appeler le vendeur">
                <svg fill="currentColor" viewBox="0 0 20 20">
                  <path d="M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.774a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z"></path>
                </svg>
              </a>
              <span class="tooltip-text">{{ product.phoneNumber }}</span>
            </div>
            <button class="product-card-button chat" title="Discuter avec le vendeur">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
              </svg>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Product Detail Modal -->
  <app-product-detail-modal
    *ngIf="selectedProduct"
    [product]="selectedProduct"
    (close)="closeProductDetailModal()"
  ></app-product-detail-modal>
</div>
